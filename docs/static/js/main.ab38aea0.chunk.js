(this["webpackJsonpstocks-view"]=this["webpackJsonpstocks-view"]||[]).push([[0],{218:function(e,t,n){e.exports=n(467)},223:function(e,t,n){},225:function(e,t,n){},242:function(e,t,n){},276:function(e,t,n){},362:function(e,t,n){},452:function(e,t,n){},465:function(e,t,n){},467:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),o=n(4),s=n.n(o),i=n(18),u=(n(223),n(13)),l=n.n(u),f=n(19),d=(n(225),n(42)),v=n(63),p=n(191),k=n.n(p),m=n(476),b=n(470);!function(e){e.GetStocks="stocks/list",e.GetStock="stocks/get",e.GetCandles="symbols/candles"}(r||(r={}));var h=function(){function e(){Object(d.a)(this,e),this.client=void 0,this.client=k.a.create({baseURL:"https://api.tinkoff.ru/trading"})}return Object(v.a)(e,[{key:"getStocks",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={tickers:t,country:"All",orderType:"Desc",sortType:"ByEarnings"},t&&(n.tickers=t),e.next=4,this.requestMethod(r.GetStocks,n);case 4:return a=e.sent,e.abrupt("return",a.values);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchStocks",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,a,c,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:20,a={country:"All",orderType:"Desc",sortType:"ByEarnings",start:0,end:n},t&&(a.filter=t),e.next=5,this.requestMethod(r.GetStocks,a);case 5:return c=e.sent,e.abrupt("return",c.values);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStock",value:function(){var e=Object(f.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requestMethod(r.GetStock,{ticker:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCandles",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,a=Object(m.a)(n,1),e.next=4,this.requestMethod(r.GetCandles,{from:Object(b.a)(a),to:Object(b.a)(n),resolution:5,ticker:t});case 4:return c=e.sent,e.abrupt("return",c.candles);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestMethod",value:function(){var e=Object(f.a)(l.a.mark((function e(t,n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.post(t,n);case 2:if(r=e.sent,!("code"in(a=r.data.payload))||!("message"in a)){e.next=6;break}throw new Error(a.message);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),g=n(472);n(242);function E(e){var t=c.a.createElement("div",{className:"title-skeleton"});return c.a.createElement("div",{className:"main-layout"},c.a.createElement(g.a,{className:"header",onBack:e.onBack,title:e.title||t,subTitle:e.subtitle,extra:e.extra}),c.a.createElement("div",{className:"body"},e.children))}var y=function(e){return{type:"SET_STOCKS",stocks:e}},O=n(56),w=n(474),j=n(197);n(276);function S(e){var t=function(e){var t=["stock-earnings"];return 0===e.earnings.relative||(e.earnings.relative>0?t.push("positive"):t.push("negative")),t},n=function(e){var t=e.symbol.logoName.replace(".png","x160.png");return"https://static.tinkoff.ru/brands/traiding/".concat(t)},r=function(n){return e.manage?c.a.createElement("div",{className:"delete-button-container"},c.a.createElement(O.a,{type:"primary",danger:!0,onClick:function(){var t;return null===(t=e.onDelete)||void 0===t?void 0:t.call(e,n)}},"Delete")):c.a.createElement("div",{className:"price-container"},c.a.createElement("div",{className:"stock-price"},function(e){var t=e.price.value.toFixed(2),n=e.price.currency;return"".concat(t," ").concat(n)}(n)),c.a.createElement("div",{className:t(n).join(" ")},function(e){var t=e.earnings.absolute.value.toFixed(2),n=e.earnings.absolute.currency,r=Math.abs(100*e.earnings.relative).toFixed(2);return"".concat(t," ").concat(n," (").concat(r,"%)")}(n)))};return c.a.createElement(w.b,{className:"stocks-list",loading:!e.stocks,dataSource:e.stocks||[],renderItem:function(t){return c.a.createElement(w.b.Item,{className:["item",t.symbol.isin].join(" "),key:t.symbol.isin,onClick:function(){return function(t){var n;null===(n=e.onSelect)||void 0===n||n.call(e,t)}(t)}},c.a.createElement(w.b.Item.Meta,{avatar:c.a.createElement(j.a,{src:n(t)}),title:t.symbol.showName,description:t.symbol.ticker}),c.a.createElement("div",{className:"content"},r(t)))}})}var C=n(9),x=n(34),N=function(e,t){return e.stocks.includes(t.stock)?e:Object(x.a)({},e,{stocks:[].concat(Object(C.a)(e.stocks),[t.stock])})},T=function(e,t){return e.stocks.includes(t.stock)?e:Object(x.a)({},e,{stocks:e.stocks.filter((function(e){return e!==t.stock}))})},A={stocks:[]},R=function(e,t){if(e.tickers.includes(t.ticker))return e;var n=[].concat(Object(C.a)(e.tickers),[t.ticker]);return localStorage.setItem("tickers",JSON.stringify(n)),Object(x.a)({},e,{tickers:n})},D=function(e,t){if(!e.tickers.includes(t.ticker))return e;var n=e.tickers.filter((function(e){return e!==t.ticker}));return localStorage.setItem("tickers",JSON.stringify(n)),Object(x.a)({},e,{tickers:n})},I={tickers:["V","ADBE","AAPL","INTC","FB","AMD","GOOGL","GOOG","NVDA","MSFT","MA"]},M=n(81),B=n(82),K=Object(M.b)({stocks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STOCKS":return Object(x.a)({},e,{stocks:t.stocks});case"ADD_STOCK":return N(e,t);case"REMOVE_STOCK":return T(e,t);case"CLEAR_STOCKS":return Object(x.a)({},e,{stocks:[]});default:return e}},tickers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TICKERS":return localStorage.setItem("tickers",JSON.stringify(t.tickers)),Object(x.a)({},e,{tickers:t.tickers});case"ADD_TICKER":return R(e,t);case"REMOVE_TICKER":return D(e,t);case"CLEAR_TICKERS":return localStorage.setItem("tickers","[]"),Object(x.a)({},e,{tickers:[]});default:return e}}}),_=Object(M.c)(K),G=function(){return[Object(B.c)((function(e){return e})),Object(B.b)()]},L=n(478),W=n(52),H=function(e){return{type:"SET_TICKERS",tickers:e}},J=function(e){return{type:"ADD_TICKER",ticker:e}},F=function(e){return{type:"REMOVE_TICKER",ticker:e}},q=n(138),V=n.n(q),P=n(477),U=new h;function z(){var e=G(),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),s=Object(i.a)(o,2),u=s[0],d=s[1];Object(a.useEffect)((function(){(function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.getStocks(n.tickers.tickers);case 3:t=e.sent,r(y(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[r,n.tickers.tickers]);return c.a.createElement(E,{title:"Stocks view",extra:[c.a.createElement(O.a,{onClick:function(){d(!u)},type:u?"primary":"default"},u?"Finish":"Manage")]},c.a.createElement("div",{className:"main-view"},c.a.createElement("div",{className:"stock-list-container"},c.a.createElement(S,{stocks:n.stocks.stocks,manage:u,onSelect:function(e){},onDelete:function(e){V()({title:"Do you want to delete ".concat(e.symbol.showName,"?"),icon:c.a.createElement(P.a,null),centered:!0,okButtonProps:{type:"primary",danger:!0},onOk:function(){r(F(e.symbol.ticker))},onCancel:function(){}})}})),!u&&c.a.createElement(W.b,{to:"/add-stock"},c.a.createElement(O.a,{className:"add-stock-button",type:"primary",icon:c.a.createElement(L.a,null),block:!0},"Add stock"))))}var $=n(11),Q=(n(362),n(208)),X=n(473),Y=n(471),Z=new h;function ee(){var e=Object($.h)(),t=Object(a.useRef)(),n=Object(a.useState)(),r=Object(i.a)(n,2),o=r[0],s=r[1],u=Object(a.useState)(),d=Object(i.a)(u,2),v=d[0],p=d[1];Object(a.useEffect)((function(){t.current=e.ticker})),Object(a.useEffect)((function(){(function(){var e=Object(f.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.current){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.t0=s,e.next=7,Z.getStock(n);case 7:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=p,e.next=12,Z.getCandles(n);case 12:e.t3=e.sent,(0,e.t2)(e.t3),e.next=19;break;case 16:e.prev=16,e.t4=e.catch(3),console.warn(e.t4.message);case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);var k=c.a.createElement("div",{className:"chart-container"},c.a.createElement(Q.a,{data:{labels:(null===v||void 0===v?void 0:v.map((function(e){return Object(X.a)(Object(Y.a)(e.date),"HH:mm MM/dd")})))||[],datasets:[{label:"Candles",fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:(null===v||void 0===v?void 0:v.map((function(e){return e.c})))||[]}]},options:{scales:{yAxes:[{ticks:{display:!1}}]}},width:4e3,height:400}));return c.a.createElement(E,{title:null===o||void 0===o?void 0:o.symbol.showName,subtitle:null===o||void 0===o?void 0:o.symbol.ticker},c.a.createElement("div",{className:"stock-details-view"},v&&k))}n(452);var te=n(475),ne=n(479),re=new h;function ae(){var e=Object($.f)(),t=Object(a.useState)(),n=Object(i.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(),u=Object(i.a)(s,2),d=u[0],v=u[1],p=function(e,t){var n=Object(a.useState)(e),r=Object(i.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)((function(){var n=setTimeout((function(){o(e)}),t);return function(){clearTimeout(n)}}),[e,t]),c}(r,200),k=G(),m=Object(i.a)(k,2)[1];Object(a.useEffect)((function(){return function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.searchStocks(p);case 3:t=e.sent,v(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()(),function(){v(void 0)}}),[p]);return c.a.createElement(E,{title:"Add new stock"},c.a.createElement("div",{className:"add-stock-view"},c.a.createElement("div",{className:"search-container"},c.a.createElement(te.a,{size:"large",placeholder:"Enter stock ticker or name",value:r,onChange:function(e){return o(e.currentTarget.value)},prefix:c.a.createElement(ne.a,null)})),c.a.createElement("div",{className:"stocks-list-container"},c.a.createElement(S,{stocks:d,onSelect:function(t){m(J(t.symbol.ticker)),e.push("/")}}))))}var ce=n(145);function oe(e){return{opacity:e.opacity,transform:"scale(".concat(e.scale,")")}}function se(e){return Object(ce.b)(e,{stiffness:330,damping:22})}var ie={atEnter:{opacity:0,scale:1.2},atLeave:{opacity:se(0),scale:se(.8)},atActive:{opacity:se(1),scale:se(1)}};function ue(){var e=G(),t=Object(i.a)(e,2)[1];return Object(a.useEffect)((function(){try{var e=localStorage.getItem("tickers");if(!e)throw new Error;var n=JSON.parse(e);t(H(n))}catch(r){}}),[]),c.a.createElement(W.a,{basename:"/stocks-view-app"},c.a.createElement("div",{className:"stocks-view-app"},c.a.createElement(ce.a,{atEnter:ie.atEnter,atLeave:ie.atLeave,atActive:ie.atActive,mapStyles:oe,className:"route-wrapper"},c.a.createElement($.a,{exact:!0,path:"/",component:z}),c.a.createElement($.a,{path:"/stock-details/:ticker",component:ee}),c.a.createElement($.a,{path:"/add-stock",component:ae}))))}var le=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(464),n(465);s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(B.a,{store:_},c.a.createElement(ue,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/stocks-view-app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/stocks-view-app","/service-worker.js");le?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):fe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):fe(t,e)}))}}({})}},[[218,1,2]]]);
//# sourceMappingURL=main.ab38aea0.chunk.js.map