{"version":3,"sources":["api/TinkoffTradingApi.ts","layouts/MainLayout.tsx","store/stocks/types.ts","store/stocks/actions.ts","utils/getCurrencySymbol.ts","widgets/StocksList/StocksList.tsx","store/stocks/store.ts","store/tickers/store.ts","store/store.ts","components/BottomButton/BottomButton.tsx","views/MainView/MainView.tsx","store/tickers/actions.ts","store/tickers/types.ts","views/StocksDetailsView/StockDetailsView.tsx","views/AddStockView/AddStockView.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["RequestMethod","TinkoffTradingApi","client","pulseClient","this","axios","create","baseURL","tickers","params","country","orderType","sortType","requestMethod","GetStocks","stocksList","values","query","amount","start","end","filter","ticker","GetStock","dateNow","Date","todayIsWeekend","isWeekend","dateTo","sub","lastDayOfWeek","weekStartsOn","hours","minutes","dateFrom","subDays","GetCandles","from","formatISO","to","resolution","candles","limit","requestPulseMethod","postList","items","postId","commentList","method","post","response","payload","data","Error","message","path","get","MainLayoutComponent","props","titleSkeleton","className","onBack","title","subTitle","subtitle","extra","children","setStocks","stocks","type","currency","symbol","USD","RUB","StocksListComponent","getEarningsClassNames","stock","classNames","earnings","relative","push","getLogoUrl","logoName","replace","getContent","manage","danger","onClick","onDelete","fixedPrice","price","value","toFixed","priceCurrencySymbol","getCurrencySymbol","getPriceText","join","CaretUpOutlined","CaretDownOutlined","getEarningsCaret","earningsFixedAbsoluteValue","absolute","earningsCurrencySymbol","earningsFixedRelativeValue","Math","abs","getEarningsText","loading","dataSource","renderItem","Item","isin","key","onSelect","handleListItemClick","Meta","avatar","src","showName","description","addStockReducer","state","action","find","removeStockReducer","initialState","undefined","addTickerReducer","includes","localStorage","setItem","JSON","stringify","removeTickerReducer","rootReducer","combineReducers","store","createStore","useAppStore","useSelector","useDispatch","BottomButtonComponent","tradingApi","MainViewComponent","history","useHistory","dispatch","useEffect","updateStocks","a","getStocks","console","warn","intervalStopped","interval","_iteration","stop","icon","PlusOutlined","block","setTickers","addTicker","removeTicker","StockDetailsViewComponent","useParams","chartRef","createRef","tickerRef","useRef","useState","setStock","setCandles","posts","setPosts","comments","setComments","current","updateStock","getStock","updateCandles","getCandles","updatePosts","getPulsePosts","Promise","all","map","getPulseComments","id","postsComments","allComments","reduce","acc","postComments","index","length","chartEl","chart","F2","Chart","el","pixelRatio","window","devicePixelRatio","candle","date","fromUnixTime","c","source","mask","slice","item","formatter","val","tooltip","showCrosshairs","showItemMarker","background","radius","fill","nameStyle","onShow","ev","name","scrollBar","mode","xStyle","offsetY","area","position","shape","line","interaction","render","handleRemoveButtonClick","confirm","ExclamationCircleOutlined","centered","okButtonProps","onOk","onCancel","handleAddButtonClick","getPostOrCommentAvatar","image","nickname","color","size","round","avatarUrl","alt","getPosts","author","content","text","datetime","formatDistanceToNow","parseISO","inserted","addSuffix","actions","LikeFilled","likesCount","comment","getComments","ref","Empty","PRESENTED_IMAGE_SIMPLE","lastPrice","currencySymbol","getStockPriceText","DeleteOutlined","AddStockViewComponent","setQuery","debouncedQuery","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","useDebounce","searchStocks","placeholder","onChange","e","currentTarget","prefix","SearchOutlined","AppComponent","basename","process","exact","component","tickersJson","getItem","parse","loadTickers","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","error","ReactDOM","document","getElementById","URL","href","origin","addEventListener","fetch","headers","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.5a5aaf77.chunk.js","sourcesContent":["import axios, { AxiosInstance, AxiosResponse } from \"axios\";\nimport {\n  Stock,\n  Response,\n  StocksList,\n  Candle,\n  CandlesList,\n  PulsePost,\n  PulsePostList,\n  PulseCommentList,\n  PulseComment,\n} from \"../models/tinkoffTrading\";\nimport { subDays, formatISO, isWeekend, lastDayOfWeek, sub } from \"date-fns\";\n\nconst BASE_URL = \"https://api.tinkoff.ru/trading\";\nconst PULSE_BASE_URL = \"https://api-invest-gw.tinkoff.ru/social/v1\";\n\nexport enum RequestMethod {\n  GetStocks = \"stocks/list\",\n  GetStock = \"stocks/get\",\n  GetCandles = \"symbols/candles\",\n}\n\nexport default class TinkoffTradingApi {\n  private client!: AxiosInstance;\n  private pulseClient!: AxiosInstance;\n  constructor() {\n    this.client = axios.create({\n      baseURL: BASE_URL,\n    });\n\n    this.pulseClient = axios.create({\n      baseURL: PULSE_BASE_URL,\n    });\n  }\n\n  async getStocks(tickers?: string[]): Promise<Stock[]> {\n    const params: any = {\n      tickers,\n      country: \"All\",\n      orderType: \"Desc\",\n      sortType: \"ByEarnings\",\n    };\n\n    if (tickers) {\n      params.tickers = tickers;\n    }\n\n    const stocksList = await this.requestMethod<StocksList>(\n      RequestMethod.GetStocks,\n      params\n    );\n\n    return stocksList.values;\n  }\n\n  async searchStocks(query?: string, amount = 20): Promise<Stock[]> {\n    const params: any = {\n      country: \"All\",\n      orderType: \"Desc\",\n      sortType: \"ByEarnings\",\n      start: 0,\n      end: amount,\n    };\n\n    if (query) {\n      params.filter = query;\n    }\n\n    const stocksList = await this.requestMethod<StocksList>(\n      RequestMethod.GetStocks,\n      params\n    );\n\n    return stocksList.values;\n  }\n\n  async getStock(ticker: string): Promise<Stock> {\n    return this.requestMethod(RequestMethod.GetStock, { ticker });\n  }\n\n  async getCandles(ticker: string): Promise<Candle[]> {\n    const dateNow = new Date();\n    const todayIsWeekend = isWeekend(dateNow);\n\n    const dateTo = todayIsWeekend\n      ? sub(lastDayOfWeek(dateNow, { weekStartsOn: 1 }), {\n          hours: 22,\n          minutes: 15,\n        })\n      : dateNow;\n    const dateFrom = subDays(dateTo, 1);\n\n    const candles = await this.requestMethod<CandlesList>(\n      RequestMethod.GetCandles,\n      {\n        from: formatISO(dateFrom),\n        to: formatISO(dateTo),\n        resolution: 5,\n        ticker,\n      }\n    );\n\n    return candles.candles;\n  }\n\n  async getPulsePosts(ticker: string, limit = 50): Promise<PulsePost[]> {\n    const postList = await this.requestPulseMethod<PulsePostList>(\n      `post/instrument/${ticker}`,\n      {\n        limit,\n      }\n    );\n\n    return postList.items;\n  }\n\n  async getPulseComments(postId: string): Promise<PulseComment[]> {\n    const commentList = await this.requestPulseMethod<PulseCommentList>(\n      `post/${postId}/comment`,\n      {}\n    );\n\n    return commentList.items;\n  }\n\n  private async requestMethod<T>(\n    method: RequestMethod,\n    params: any\n  ): Promise<T> {\n    const response: AxiosResponse<Response<T>> = await this.client.post(\n      method,\n      params\n    );\n\n    const payload = response.data.payload;\n\n    if (\"code\" in payload && \"message\" in payload) {\n      throw new Error(payload.message);\n    }\n\n    return payload;\n  }\n\n  private async requestPulseMethod<T>(path: string, params: any): Promise<T> {\n    const response: AxiosResponse<Response<T>> = await this.pulseClient.get(\n      path,\n      {\n        params,\n      }\n    );\n\n    const payload = response.data.payload;\n\n    if (\"code\" in payload && \"message\" in payload) {\n      throw new Error(payload.message);\n    }\n\n    return payload;\n  }\n}\n","import React, { PropsWithChildren } from \"react\";\nimport { PageHeader } from \"antd\";\nimport \"./MainLayout.css\";\n\nexport interface MainLayoutProps {\n  title?: string;\n  subtitle?: string;\n  extra?: React.ReactNode;\n  onBack?: () => void;\n}\n\nexport default function MainLayoutComponent(\n  props: PropsWithChildren<MainLayoutProps>\n) {\n  const titleSkeleton = <div className=\"title-skeleton\" />;\n\n  return (\n    <div className=\"main-layout\">\n      <PageHeader\n        className=\"header\"\n        onBack={props.onBack}\n        title={props.title || titleSkeleton}\n        subTitle={props.subtitle}\n        extra={props.extra}\n      />\n      <div className=\"body\">{props.children}</div>\n    </div>\n  );\n}\n","import { Stock } from \"../../models/tinkoffTrading\";\n\nexport interface StocksState {\n  stocks: Stock[] | undefined;\n}\n\nexport const SET_STOCKS = \"SET_STOCKS\";\nexport const ADD_STOCK = \"ADD_STOCK\";\nexport const REMOVE_STOCK = \"REMOVE_STOCK\";\nexport const CLEAR_STOCKS = \"CLEAR_STOCKS\";\n\nexport interface SetStocksAction {\n  type: typeof SET_STOCKS;\n  stocks: Stock[];\n}\n\nexport interface AddStockAction {\n  type: typeof ADD_STOCK;\n  stock: Stock;\n}\n\nexport interface RemoveStockAction {\n  type: typeof REMOVE_STOCK;\n  stock: Stock;\n}\n\nexport interface ClearStocksAction {\n  type: typeof CLEAR_STOCKS;\n}\n\nexport type StocksActionTypes = SetStocksAction | AddStockAction | RemoveStockAction | ClearStocksAction;","import {\n  AddStockAction,\n  SetStocksAction,\n  RemoveStockAction,\n  ClearStocksAction,\n  REMOVE_STOCK,\n  ADD_STOCK,\n  SET_STOCKS,\n  CLEAR_STOCKS,\n} from \"./types\";\nimport { Stock } from \"../../models/tinkoffTrading\";\n\nexport const setStocks = (stocks: Stock[]): SetStocksAction => ({\n  type: SET_STOCKS,\n  stocks,\n});\n\nexport const addStock = (stock: Stock): AddStockAction => ({\n  type: ADD_STOCK,\n  stock,\n});\n\nexport const removeStock = (stock: Stock): RemoveStockAction => ({\n  type: REMOVE_STOCK,\n  stock,\n});\n\nexport const clearStocks = (): ClearStocksAction => ({\n  type: CLEAR_STOCKS,\n});\n\nexport const mapStocksDispatch = {\n  setStocks,\n  addStock,\n  removeStock,\n  clearStocks,\n};","export default function (currency: string): string {\n  const currencySymbols: any = {\n    USD: \"$\",\n    RUB: \"₽\",\n  };\n\n  const symbol = currencySymbols[currency];\n  if (!symbol) {\n    return currency;\n  }\n\n  return symbol;\n}\n","import React from \"react\";\nimport { List, Avatar, Button } from \"antd\";\nimport { Stock } from \"../../models/tinkoffTrading\";\nimport { CaretUpOutlined, CaretDownOutlined } from \"@ant-design/icons\";\nimport \"./StocksList.css\";\nimport getCurrencySymbol from \"../../utils/getCurrencySymbol\";\n\nexport type SelectEventHandler = (stock: Stock) => void;\n\nexport interface StocksListProps {\n  stocks?: Stock[];\n  manage?: boolean;\n  onSelect?: SelectEventHandler;\n  onDelete?: SelectEventHandler;\n}\n\nexport default function StocksListComponent(props: StocksListProps) {\n  const handleListItemClick = (stock: Stock) => {\n    props.onSelect?.(stock);\n  };\n\n  const getPriceText = (stock: Stock) => {\n    const fixedPrice = stock.price.value.toFixed(2);\n    const priceCurrencySymbol = getCurrencySymbol(stock.price.currency);\n\n    return `${fixedPrice} ${priceCurrencySymbol}`;\n  };\n\n  const getEarningsClassNames = (stock: Stock) => {\n    const classNames = [\"stock-earnings\"];\n\n    if (stock.earnings.relative === 0) {\n      return classNames;\n    }\n\n    if (stock.earnings.relative > 0) {\n      classNames.push(\"positive\");\n    } else {\n      classNames.push(\"negative\");\n    }\n\n    return classNames;\n  };\n\n  const getEarningsCaret = (stock: Stock) => {\n    if (stock.earnings.relative === 0) {\n      return undefined;\n    }\n\n    return stock.earnings.relative > 0 ? (\n      <CaretUpOutlined className=\"stock-earnings-caret\" />\n    ) : (\n      <CaretDownOutlined className=\"stock-earnings-caret\" />\n    );\n  };\n\n  const getEarningsText = (stock: Stock) => {\n    const earningsFixedAbsoluteValue = stock.earnings.absolute.value.toFixed(2);\n    const earningsCurrencySymbol = getCurrencySymbol(\n      stock.earnings.absolute.currency\n    );\n    const earningsFixedRelativeValue = Math.abs(\n      stock.earnings.relative * 100\n    ).toFixed(2);\n\n    return `${earningsFixedAbsoluteValue} ${earningsCurrencySymbol} (${earningsFixedRelativeValue}%)`;\n  };\n\n  const getLogoUrl = (stock: Stock) => {\n    const logoName = stock.symbol.logoName.replace(\".png\", \"x160.png\");\n    return `https://static.tinkoff.ru/brands/traiding/${logoName}`;\n  };\n\n  const getContent = (stock: Stock) => {\n    if (props.manage) {\n      return (\n        <div className=\"delete-button-container\">\n          <Button type=\"primary\" danger onClick={() => props.onDelete?.(stock)}>\n            Delete\n          </Button>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"price-container\">\n        <div className=\"stock-price\">{getPriceText(stock)}</div>\n        <div className={getEarningsClassNames(stock).join(\" \")}>\n          {getEarningsCaret(stock)}\n          {getEarningsText(stock)}\n        </div>\n      </div>\n    );\n  };\n\n  const renderListItem = (stock: Stock): JSX.Element => {\n    return (\n      <List.Item\n        className={[\"item\", stock.symbol.isin].join(\" \")}\n        key={stock.symbol.isin}\n        onClick={() => handleListItemClick(stock)}\n      >\n        <List.Item.Meta\n          avatar={<Avatar src={getLogoUrl(stock)} />}\n          title={stock.symbol.showName}\n          description={stock.symbol.ticker}\n        />\n        <div className=\"content\">{getContent(stock)}</div>\n      </List.Item>\n    );\n  };\n\n  return (\n    <List\n      className=\"stocks-list\"\n      loading={!props.stocks}\n      dataSource={props.stocks || []}\n      renderItem={renderListItem}\n    />\n  );\n}\n","import {\n  StocksState,\n  StocksActionTypes,\n  RemoveStockAction,\n  AddStockAction,\n} from \"./types\";\n\nconst addStockReducer = (\n  state: StocksState,\n  action: AddStockAction\n): StocksState => {\n  const stocks = state.stocks ? state.stocks : [];\n\n  if (stocks.find((stock) => stock.symbol.isin === action.stock.symbol.isin)) {\n    return state;\n  }\n\n  return { ...state, stocks: [...stocks, action.stock] };\n};\n\nconst removeStockReducer = (\n  state: StocksState,\n  action: RemoveStockAction\n): StocksState => {\n  const stocks = state.stocks ? state.stocks : [];\n\n  if (!stocks.find((stock) => stock.symbol.isin === action.stock.symbol.isin)) {\n    return state;\n  }\n\n  return { ...state, stocks: stocks.filter((stock) => stock !== action.stock) };\n};\n\nconst initialState: StocksState = {\n  stocks: undefined,\n};\n\nexport const stocksReducer = (\n  state = initialState,\n  action: StocksActionTypes\n): StocksState => {\n  switch (action.type) {\n    case \"SET_STOCKS\":\n      return { ...state, stocks: action.stocks };\n\n    case \"ADD_STOCK\":\n      return addStockReducer(state, action);\n\n    case \"REMOVE_STOCK\":\n      return removeStockReducer(state, action);\n\n    case \"CLEAR_STOCKS\":\n      return { ...state, stocks: undefined };\n\n    default:\n      return state;\n  }\n};\n\nexport const mapStocksState = (state: StocksState) => ({\n  stocks: state.stocks,\n});\n","import {\n  TickersState,\n  TickersActionTypes,\n  RemoveTickerAction,\n  AddTickerAction,\n} from \"./types\";\n\nconst addTickerReducer = (\n  state: TickersState,\n  action: AddTickerAction\n): TickersState => {\n  if (state.tickers.includes(action.ticker)) {\n    return state;\n  }\n\n  const tickers = [...state.tickers, action.ticker];\n  localStorage.setItem(\"tickers\", JSON.stringify(tickers));\n\n  return { ...state, tickers };\n};\n\nconst removeTickerReducer = (\n  state: TickersState,\n  action: RemoveTickerAction\n): TickersState => {\n  if (!state.tickers.includes(action.ticker)) {\n    return state;\n  }\n\n  const tickers = state.tickers.filter((ticker) => ticker !== action.ticker);\n  localStorage.setItem(\"tickers\", JSON.stringify(tickers));\n\n  return {\n    ...state,\n    tickers,\n  };\n};\n\nconst initialState: TickersState = {\n  tickers: [\n    \"V\",\n    \"ADBE\",\n    \"AAPL\",\n    \"INTC\",\n    \"FB\",\n    \"AMD\",\n    \"GOOGL\",\n    \"GOOG\",\n    \"NVDA\",\n    \"MSFT\",\n    \"MA\",\n  ],\n};\n\nexport const tickersReducer = (\n  state = initialState,\n  action: TickersActionTypes\n): TickersState => {\n  switch (action.type) {\n    case \"SET_TICKERS\":\n      localStorage.setItem(\"tickers\", JSON.stringify(action.tickers));\n      return { ...state, tickers: action.tickers };\n\n    case \"ADD_TICKER\":\n      return addTickerReducer(state, action);\n\n    case \"REMOVE_TICKER\":\n      return removeTickerReducer(state, action);\n\n    case \"CLEAR_TICKERS\":\n      localStorage.setItem(\"tickers\", \"[]\");\n      return { ...state, tickers: [] };\n\n    default:\n      return state;\n  }\n};\n\nexport const mapTickersState = (state: TickersState) => ({\n  tickers: state.tickers,\n});\n","import { stocksReducer } from \"./stocks/store\";\nimport { tickersReducer } from \"./tickers/store\";\nimport { combineReducers, createStore } from \"redux\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nexport const rootReducer = combineReducers({\n  stocks: stocksReducer,\n  tickers: tickersReducer,\n});\n\nexport const store = createStore(rootReducer);\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport const useAppSelector = () => useSelector((state: RootState) => state);\n\nexport type AppDispatch = typeof store.dispatch;\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\n\nexport const useAppStore = (): [RootState, AppDispatch] => [useAppSelector(), useAppDispatch()];\n","import React from \"react\";\nimport { PropsWithChildren } from \"react\";\nimport Button, { ButtonProps } from \"antd/lib/button\";\nimport \"./BottomButton.css\";\n\nexport default function BottomButtonComponent(\n  props: PropsWithChildren<ButtonProps>\n) {\n  return (\n    <Button className=\"bottom-button\" {...props}>\n      {props.children}\n    </Button>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport \"./MainView.css\";\nimport TinkoffTradingApi from \"../../api/TinkoffTradingApi\";\nimport MainLayoutComponent from \"../../layouts/MainLayout\";\nimport { setStocks } from \"../../store/stocks/actions\";\nimport StocksListComponent from \"../../widgets/StocksList/StocksList\";\nimport { Stock } from \"../../models/tinkoffTrading\";\nimport { useAppStore } from \"../../store/store\";\n// import { Button } from \"antd\";\nimport { PlusOutlined } from \"@ant-design/icons\";\nimport { Link, useHistory } from \"react-router-dom\";\n// import { removeTicker } from \"../../store/tickers/actions\";\n// import confirm from \"antd/lib/modal/confirm\";\n// import { ExclamationCircleOutlined } from \"@ant-design/icons\";\nimport interval from \"interval-promise\";\nimport BottomButtonComponent from \"../../components/BottomButton/BottomButton\";\n\nconst tradingApi = new TinkoffTradingApi();\n\nexport default function MainViewComponent() {\n  const history = useHistory();\n  const [state, dispatch] = useAppStore();\n  // const [manageModeEnabled, setManageModeEnabled] = useState(false);\n  // const tickers = useSelector((state: RootState) => state.tickers.tickers);\n\n  useEffect(() => {\n    const updateStocks = async (): Promise<void> => {\n      try {\n        const stocks = await tradingApi.getStocks(state.tickers.tickers);\n        dispatch(setStocks(stocks));\n      } catch (e) {\n        console.warn(e.message);\n      }\n    };\n\n    updateStocks();\n\n    let intervalStopped = false;\n    interval(async (_iteration, stop) => {\n      if (intervalStopped) {\n        stop();\n        return;\n      }\n\n      return updateStocks();\n    }, 5000);\n\n    return () => {\n      intervalStopped = true;\n    };\n  }, [dispatch, state.tickers.tickers]);\n\n  const handleStockSelect = (stock: Stock) => {\n    history.push(`/stock-details/${stock.symbol.ticker}`);\n  };\n\n  // const handleStockDelete = (stock: Stock) => {\n  //   confirm({\n  //     title: `Do you want to delete ${stock.symbol.showName}?`,\n  //     icon: <ExclamationCircleOutlined />,\n  //     centered: true,\n  //     okButtonProps: {\n  //       type: \"primary\",\n  //       danger: true,\n  //     },\n  //     onOk() {\n  //       dispatch(removeTicker(stock.symbol.ticker));\n  //     },\n  //     onCancel() {},\n  //   });\n  // };\n\n  // const handleManageButtonClick = () => {\n  //   setManageModeEnabled(!manageModeEnabled);\n  // };\n\n  return (\n    <MainLayoutComponent\n      title=\"Stocks\"\n      // extra={[\n      //   <Button\n      //     key=\"1\"\n      //     onClick={handleManageButtonClick}\n      //     type={manageModeEnabled ? \"primary\" : \"default\"}\n      //   >\n      //     {manageModeEnabled ? \"Finish\" : \"Manage\"}\n      //   </Button>,\n      // ]}\n    >\n      <div className=\"main-view\">\n        <div className=\"stock-list-container\">\n          <StocksListComponent\n            stocks={state.stocks.stocks}\n            // manage={manageModeEnabled}\n            onSelect={handleStockSelect}\n            // onDelete={handleStockDelete}\n          />\n        </div>\n        {/* {!manageModeEnabled && ( */}\n        <Link to=\"/add-stock\">\n          <BottomButtonComponent type=\"primary\" icon={<PlusOutlined />} block>\n            Add stock\n          </BottomButtonComponent>\n        </Link>\n        {/* )} */}\n      </div>\n    </MainLayoutComponent>\n  );\n}\n","import {\n  AddTickerAction,\n  ADD_TICKER,\n  RemoveTickerAction,\n  REMOVE_TICKER,\n  SET_TICKERS,\n  SetTickersAction,\n  ClearTickersAction,\n  CLEAR_TICKERS,\n} from \"./types\";\n\nexport const setTickers = (tickers: string[]): SetTickersAction => ({\n  type: SET_TICKERS,\n  tickers,\n});\n\nexport const addTicker = (ticker: string): AddTickerAction => ({\n  type: ADD_TICKER,\n  ticker,\n});\n\nexport const removeTicker = (ticker: string): RemoveTickerAction => ({\n  type: REMOVE_TICKER,\n  ticker,\n});\n\nexport const clearTickers = (): ClearTickersAction => ({\n  type: CLEAR_TICKERS,\n});\n\nexport const mapTickersDispatch = {\n  setTickers,\n  addTicker,\n  removeTicker,\n  clearTickers,\n};\n","export const SET_TICKERS = \"SET_TICKERS\";\nexport const ADD_TICKER = \"ADD_TICKER\";\nexport const REMOVE_TICKER = \"REMOVE_TICKER\";\nexport const CLEAR_TICKERS = \"CLEAR_TICKERS\";\n\nexport interface TickersState {\n  tickers: string[];\n}\n\nexport interface SetTickersAction {\n  type: typeof SET_TICKERS;\n  tickers: string[];\n}\n\nexport interface AddTickerAction {\n  type: typeof ADD_TICKER;\n  ticker: string;\n}\n\nexport interface RemoveTickerAction {\n  type: typeof REMOVE_TICKER;\n  ticker: string;\n}\n\nexport interface ClearTickersAction {\n  type: typeof CLEAR_TICKERS;\n}\n\nexport type TickersActionTypes = SetTickersAction | AddTickerAction | RemoveTickerAction | ClearTickersAction;","import React, { useEffect, useState, useRef, createRef } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport \"./StockDetailsView.css\";\nimport {\n  Stock,\n  Candle,\n  PulsePost,\n  PulseComment,\n} from \"../../models/tinkoffTrading\";\nimport TinkoffTradingApi from \"../../api/TinkoffTradingApi\";\nimport MainLayoutComponent from \"../../layouts/MainLayout\";\n// @ts-ignore\nimport F2 from \"@antv/f2/lib/index-all\";\nimport { fromUnixTime, formatDistanceToNow, parseISO } from \"date-fns\";\nimport getCurrencySymbol from \"../../utils/getCurrencySymbol\";\nimport BottomButtonComponent from \"../../components/BottomButton/BottomButton\";\nimport {\n  DeleteOutlined,\n  ExclamationCircleOutlined,\n  PlusOutlined,\n} from \"@ant-design/icons\";\nimport confirm from \"antd/lib/modal/confirm\";\nimport { removeTicker, addTicker } from \"../../store/tickers/actions\";\nimport { useAppStore } from \"../../store/store\";\nimport { Spin, Comment, Avatar, Empty } from \"antd\";\nimport LetterAvatar from \"react-avatar\";\nimport { LikeFilled } from \"@ant-design/icons\";\n// @ts-ignore\nimport ReadMoreReact from \"read-more-react\";\n\nconst tradingApi = new TinkoffTradingApi();\n\nexport interface StockDetailsViewRouteParams {\n  ticker: string;\n}\n\nexport default function StockDetailsViewComponent() {\n  const history = useHistory();\n  const [state, dispatch] = useAppStore();\n  const params = useParams<StockDetailsViewRouteParams>();\n  const chartRef = createRef<HTMLCanvasElement>();\n  const tickerRef = useRef<string>();\n  const [stock, setStock] = useState<Stock>();\n  const [candles, setCandles] = useState<Candle[]>();\n  const [posts, setPosts] = useState<PulsePost[]>();\n  const [comments, setComments] = useState<{\n    [postId: string]: PulseComment[];\n  }>();\n\n  useEffect(() => {\n    tickerRef.current = params.ticker;\n  });\n\n  useEffect(() => {\n    const updateStock = async () => {\n      const ticker = tickerRef.current;\n      if (!ticker) return;\n\n      try {\n        const stock = await tradingApi.getStock(ticker);\n        setStock(stock);\n      } catch (e) {\n        console.warn(e.message);\n      }\n    };\n\n    const updateCandles = async () => {\n      const ticker = tickerRef.current;\n      if (!ticker) return;\n\n      try {\n        const candles = await tradingApi.getCandles(ticker);\n        setCandles(candles);\n      } catch (e) {\n        console.warn(e.message);\n      }\n    };\n\n    const updatePosts = async () => {\n      const ticker = tickerRef.current;\n      if (!ticker) return;\n\n      try {\n        const posts = await tradingApi.getPulsePosts(ticker);\n\n        const postsComments = await Promise.all(\n          posts.map((post) => {\n            return tradingApi.getPulseComments(post.id);\n          })\n        );\n\n        const allComments = postsComments.reduce((acc, postComments, index) => {\n          const postId = posts[index].id;\n          return { ...acc, [postId]: postComments };\n        }, {});\n\n        setPosts(posts);\n        setComments(allComments);\n      } catch (e) {\n        console.warn(e.message);\n      }\n    };\n\n    updateStock();\n    updateCandles();\n    updatePosts();\n  }, [tickerRef]);\n\n  useEffect(() => {\n    if (!stock || !candles || !candles.length) return;\n\n    const chartEl = chartRef.current;\n    if (!chartEl) return;\n\n    const chart = new F2.Chart({\n      el: chartEl,\n      pixelRatio: window.devicePixelRatio,\n    });\n\n    const data = candles.map((candle) => ({\n      date: fromUnixTime(candle.date),\n      price: candle.c,\n    }));\n\n    chart.source(data, {\n      date: {\n        type: \"timeCat\",\n        mask: \"HH:mm\",\n        values: data.slice(-60).map((item) => item.date),\n      },\n      price: {\n        formatter: (val: number) => {\n          return `${val.toFixed(2)} ${getCurrencySymbol(stock.price.currency)}`;\n        },\n      },\n    });\n\n    chart.tooltip({\n      showCrosshairs: true,\n      showItemMarker: false,\n      background: {\n        radius: 2,\n        fill: \"#1890FF\",\n        // padding: [3, 5],\n      },\n      nameStyle: {\n        fill: \"#fff\",\n      },\n      onShow: (ev: any) => {\n        const items = ev.items;\n        // console.log(items);\n        items[0].name = items[0].title;\n      },\n    });\n\n    chart.scrollBar({\n      mode: \"x\",\n      xStyle: {\n        offsetY: -5,\n      },\n    });\n\n    chart.area().position(\"date*price\").shape(\"smooth\");\n    chart.line().position(\"date*price\").shape(\"smooth\");\n\n    chart.interaction(\"pan\");\n    chart.render();\n  }, [chartRef, candles, stock]);\n\n  const handleRemoveButtonClick = () => {\n    confirm({\n      title: `Do you want to delete ${\n        stock?.symbol.showName || params.ticker\n      }?`,\n      icon: <ExclamationCircleOutlined />,\n      centered: true,\n      okButtonProps: {\n        type: \"primary\",\n        danger: true,\n      },\n      onOk() {\n        dispatch(removeTicker(params.ticker));\n        history.push(\"/\");\n      },\n      onCancel() {},\n    });\n  };\n\n  const handleAddButtonClick = () => {\n    dispatch(addTicker(params.ticker));\n    history.push(\"/\");\n  };\n\n  const isStockAdded = () => {\n    return state.tickers.tickers.includes(params.ticker);\n  };\n\n  const getStockActionButton = () => {\n    if (isStockAdded()) {\n      return (\n        <BottomButtonComponent\n          type=\"primary\"\n          danger\n          icon={<DeleteOutlined />}\n          block\n          onClick={handleRemoveButtonClick}\n        >\n          Remove\n        </BottomButtonComponent>\n      );\n    }\n\n    return (\n      <BottomButtonComponent\n        type=\"primary\"\n        icon={<PlusOutlined />}\n        block\n        onClick={handleAddButtonClick}\n      >\n        Add\n      </BottomButtonComponent>\n    );\n  };\n\n  const getPostOrCommentAvatar = (post: PulsePost | PulseComment) => {\n    if (!post.image) {\n      return (\n        <LetterAvatar\n          name={post.nickname}\n          color=\"#1890FF\"\n          size=\"32\"\n          round={true}\n        />\n      );\n    }\n\n    const avatarUrl = `https://api-invest-gw.tinkoff.ru/social/file/v1/cache/profile/avatar/${post.image}?size=small`;\n    return <Avatar src={avatarUrl} alt={post.nickname} />;\n  };\n\n  const getComments = (post: PulsePost) => {\n    const postComments = comments?.[post.id];\n    if (!postComments) {\n      return undefined;\n    }\n\n    return postComments.map((comment) => {\n      return (\n        <Comment\n          className=\"comment\"\n          key={comment.id}\n          author={comment.nickname}\n          avatar={getPostOrCommentAvatar(comment)}\n          content={\n            <div className=\"comment-content\">\n              <ReadMoreReact text={comment.text.replace(/\\{\\$(.*?)\\}/g, \"$1\")} />\n            </div>\n          }\n          datetime={formatDistanceToNow(parseISO(comment.inserted), {\n            addSuffix: true,\n          })}\n          actions={[\n            <div className=\"comment-likes\">\n              <LikeFilled className=\"like-icon\" />\n              {comment.likesCount}\n            </div>,\n          ]}\n        />\n      );\n    });\n    // comments?.[post.id]\n  };\n\n  const getPosts = () => {\n    if (!posts) {\n      return undefined;\n    }\n\n    return posts.map((post) => {\n      return (\n        <Comment\n          className=\"comment\"\n          key={post.id}\n          author={post.nickname}\n          avatar={getPostOrCommentAvatar(post)}\n          content={\n            <div className=\"comment-content\">\n              <ReadMoreReact text={post.text.replace(/\\{\\$(.*?)\\}/g, \"$1\")} />\n            </div>\n          }\n          datetime={formatDistanceToNow(parseISO(post.inserted), {\n            addSuffix: true,\n          })}\n          actions={[\n            <div className=\"comment-likes\">\n              <LikeFilled className=\"like-icon\" />\n              {post.likesCount}\n            </div>,\n          ]}\n        >\n          {getComments(post)}\n        </Comment>\n      );\n    });\n  };\n\n  const getChart = () => {\n    if (!stock || !candles || !candles.length) {\n      return <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} />;\n    }\n\n    return <canvas className=\"chart-canvas\" ref={chartRef} />;\n  };\n\n  const getStockPriceText = () => {\n    if (!stock || !candles || !candles.length) return;\n\n    const lastPrice = candles[candles.length - 1].c;\n    const currencySymbol = getCurrencySymbol(stock.price.currency);\n    return `${lastPrice} ${currencySymbol}`;\n  };\n\n  const getDetails = () => {\n    if (!candles || !stock || !posts) {\n      return (\n        <div className=\"spin-container\">\n          <Spin />\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"details\">\n        {getChart()}\n        <div className=\"details-price\">{getStockPriceText()}</div>\n        <div className=\"details-posts\">{getPosts()}</div>\n      </div>\n    );\n  };\n\n  return (\n    <MainLayoutComponent\n      title={stock?.symbol.showName}\n      subtitle={stock?.symbol.ticker}\n    >\n      <div className=\"stock-details-view\">\n        <div className=\"details-container\">{getDetails()}</div>\n        {getStockActionButton()}\n      </div>\n    </MainLayoutComponent>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport \"./AddStockView.css\";\nimport MainLayoutComponent from \"../../layouts/MainLayout\";\nimport { Input } from \"antd\";\nimport { SearchOutlined } from \"@ant-design/icons\";\nimport TinkoffTradingApi from \"../../api/TinkoffTradingApi\";\nimport { Stock } from \"../../models/tinkoffTrading\";\nimport StocksListComponent from \"../../widgets/StocksList/StocksList\";\nimport { useHistory } from \"react-router-dom\";\n\nconst tradingApi = new TinkoffTradingApi();\n\nfunction useDebounce<T>(value: T, delay: number): T {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  );\n\n  return debouncedValue;\n}\n\nexport default function AddStockViewComponent() {\n  const history = useHistory();\n  const [query, setQuery] = useState<string>();\n  const [stocks, setStocks] = useState<Stock[]>();\n  const debouncedQuery = useDebounce(query, 200);\n\n  useEffect(() => {\n    const updateStocks = async (): Promise<void> => {\n      try {\n        const stocks = await tradingApi.searchStocks(debouncedQuery);\n        setStocks(stocks);\n      } catch (e) {\n        console.warn(e.message);\n      }\n    };\n\n    updateStocks();\n\n    return () => {\n      setStocks(undefined);\n    };\n  }, [debouncedQuery]);\n\n  const handleStockSelect = (stock: Stock) => {\n    history.push(`/stock-details/${stock.symbol.ticker}`);\n  };\n\n  return (\n    <MainLayoutComponent title=\"Add new stock\">\n      <div className=\"add-stock-view\">\n        <div className=\"search-container\">\n          <Input\n            size=\"large\"\n            placeholder=\"Enter stock ticker or name\"\n            value={query}\n            onChange={(e) => setQuery(e.currentTarget.value)}\n            prefix={<SearchOutlined />}\n          />\n        </div>\n        <div className=\"stocks-list-container\">\n          <StocksListComponent stocks={stocks} onSelect={handleStockSelect} />\n        </div>\n      </div>\n    </MainLayoutComponent>\n  );\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport MainViewComponent from \"./views/MainView/MainView\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport StockDetailsViewComponent from \"./views/StocksDetailsView/StockDetailsView\";\nimport AddStockViewComponent from \"./views/AddStockView/AddStockView\";\n// @ts-ignore\nimport { store } from \"./store/store\";\nimport { setTickers } from \"./store/tickers/actions\";\nimport { Switch } from \"react-router-dom\";\n\nfunction loadTickers() {\n  try {\n    const tickersJson = localStorage.getItem(\"tickers\");\n    if (!tickersJson) {\n      throw new Error();\n    }\n\n    const tickers = JSON.parse(tickersJson);\n    store.dispatch(setTickers(tickers));\n  } catch (e) {}\n}\n\nloadTickers();\n\nexport function AppComponent() {\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n      <div className=\"stocks-view-app\">\n        <Switch>\n          <Route exact path=\"/\" component={MainViewComponent} />\n          <Route\n            path=\"/stock-details/:ticker\"\n            component={StockDetailsViewComponent}\n          />\n          <Route path=\"/add-stock\" component={AddStockViewComponent} />\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config: any) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config: any) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config: any) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { AppComponent } from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport \"antd/dist/antd.css\";\nimport \"./index.css\";\nimport { Provider } from \"react-redux\";\nimport { store } from \"./store/store\";\n\nReactDOM.render(\n  // <React.StrictMode>\n  <Provider store={store}>\n    <AppComponent />\n  </Provider>,\n  // </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\nserviceWorker.register({});\n"],"sourceRoot":""}